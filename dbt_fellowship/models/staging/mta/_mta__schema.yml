version: 2

models:
  - name: stg_stations
    description: >
      Staged data from the MTA Subway Stations dataset (https://data.ny.gov/Transportation/MTA-Subway-Stations/39hk-dx4f/about_data).
      Documentation directly copied from MTA Data Dictionary. 
    columns:
      - name: "gtfs_stop_id"
        description: >
          The ID used for the station in the General Transit Feed Specification (GTFS), an open standard used to 
          display public transit schedule data.
        tests:
          - unique
          - not_null
      - name: "station_id"
        description: The Station Master Reference Number.
        tests:
          - not_null
      - name: "complex_id"
        description: The Complex Master Reference Number.
        tests:
          - not_null
      - name: "line"
        description: >
          The operational line of the subway system the station is located on, such as Queens
          Blvd, Lexington Av, or Sea Beach.
      - name: "stop_name"
        description: The name of the subway station.
      - name: "borough"
        description: >
          The borough the station is in. Bx for Bronx, B for Brooklyn, M for Manhattan, Q for
          Queens, SI for Staten Island. 
      - name: "gtfs_latitude"
        description: The latitude for the centroid of the station
      - name: "gtfs_longitude"
        description: The longitude for the centroid of the station
      - name: "ada"
        description: >
          0 if the station is not ADA-accessible, 1 if the station is fully accessible, 
          2 if the station is partially accessible. 
      - name: "ada_northbound"
        description: >
          0 if the station is not ADA-accessible in the northbound direction, 1 if the station is fully
          accessible in the northbound direction.
      - name: "ada_southbound"
        description: > 
          0 if the station is not ADA-accessible in the southbound direction, 1 if the station is fully
          accessible in the southbound direction
  - name: stg_hourly_ridership_20230102
    description: >
      Staged data from the MTA Subway Hourly Ridership dataset (https://data.ny.gov/Transportation/MTA-Subway-Hourly-Ridership-Beginning-February-202/wujg-7c2s/about_data).
      Documentation copied directly from the MTA Data Dictionary, and filtered to transit_timestamp = "'2023-01-02T00:00:00'".
    columns:
      - name: "transit_timestamp"
        description: >
          Timestamp payment took place in local time. All transactions here are rounded down to the nearest
          hour. For example, a swipe that took place at 1:37pm will be reported as having taken place at 1pm.
      - name: "transit_mode"
        description: Distinguishes between the subway, Staten Island Railway, and the Roosevelt Island Tram
      - name: "station_complex_id"
        description: A unique identifier for station complexes
      - name: "station_complex"
        description: >
          The subway complex where an entry swipe or tap took place. Large subway complexes, such as Times Square
          and Fulton Center, may contain multiple subway lines. The subway complex name includes the routes that stop 
          at the complex in parenthesis, such as Zerega Av (6).
      - name: "payment_method"
        description: Specifies whether the payment method used to enter was from OMNY or MetroCard.
      - name: "fare_class_category"
        description: >
          The class of fare payment used for the trip. The consolidated categories are:
          • MetroCard (Fair Fare)
          • MetroCard (Full Fare)
          • MetroCard (Other)
          • MetroCard (Senior & Disability)
          • MetroCard (Students)
          • MetroCard (Unlimited 30-Day)
          • MetroCard (Unlimited 7-Day)
          • OMNY (Full Fare)
          • OMNY (Other)
          • OMNY (Seniors & Disabilities)
      - name: "ridership"
        description: >
          Total number of riders that entered a subway complex via OMNY or MetroCard at the specific hour and for that
          specific fare type.
      - name: "transfers"
        description: >
          Number of individuals who entered a subway complex via a free bus-to-subway, or free out-of-network
          transfer. This represents a subset of total ridership, meaning that these transfers are already included in the
          preceding ridership column. Transfers that take place within a subway complex (e.g., individuals transferring
          from the 2 to the 4 train within Atlantic Avenue) are not captured here.
  - name: stg_origin_destination_20230102
    description: >
      Staged data from the MTA Origin-Destination Ridership Estimate: 2023 dataset (https://data.ny.gov/Transportation/MTA-Subway-Origin-Destination-Ridership-Estimate-2/uhf3-t34z/about_data).
      Documentation is copied directly from the data dictionary and table is filtered to timestamp = "'2023-01-02T00:00:00'".

      This dataset provides an estimate of subway travel patterns based on scaled-up OMNY and MetroCard return swipe data. It provides estimated passenger volumes for all populated origin-destination 
      (O-D) pairs aggregated by month, day of the week, and hour of day. It also provides the name, ID, and approximate latitude and longitude of the origin and destination subway complexes.
    columns: 
      - name: origin_month
        description: The month in which the subway trips occurred.
      - name: origin_day_of_week
        description: The day of the week on which the subway trips occurred (Monday, Tuesday, etc.).
      - name: origin_hour_of_day
        description: The hour of the day in which the subway trips occurred. All trip times are rounded down to the nearest hour.
      - name: origin_timestamp
        description: Representative datetime for the year, month, day of week, and hour of day in which the subway trips occurred. This date will be from the first full week of the month.
      - name: origin_station_complex_id
        description: The unique identifier for the subway station complex where the trips originated.
      - name: origin_station_complex_name
        description: The name of the subway station complex where the trips originated.
      - name: destination_station_complex_id
        description: The unique identifier for the subway station complex where the trips are inferred to have ended.
      - name: destination_station_complex_name
        description: The name of the subway station complex where the trips are inferred to have ended.
      - name: estimated_average_ridership
        description: The estimated ridership for an origin-destination pair and hour of day, averaged by day of week over the calendar month.
  - name: stg_nearest_ada_stations
    description: > 
      This table details the 30 stations that are eligible for ADA access improvements under the 2025-2029 Capital Plan ([Ashwin to insert link]). 
      The planned_ada_station_name is copied exactly from the Capital Plan, and is duplicated in two separate cases (where multiple stations within
      a complex are part of the ADA expansion). To find which specific subway lines each station_id references, you should join to stg_stations.
      
      The northbound and southbound complexes that are referenced are my *best guess* as to which at least partially ADA-accessible complex someone would exit from in either 
      direction on the line. In this case "partially ADA-accesisble" means any complex that has at least one record in stg_stations with ada = 1. 

    columns:
      - name: mta_sort_order
        description: The order that the planned_ada_station_name appeared in the Capital Plan. It's unknown if this number is an indication of priority or if it's arbitrary.
      - name: planned_ada_complex_id
        description: The complex_id that the station_id belongs to in stg_stations. 
      - name: planned_ada_station_id
        description: My best guess as to the matching station_id available in stg_stations. 
      - name: planned_ada_station_name
        description: The exact station name referenced in pg. 187 (pdf pg. 95). May be repeated across records in case the station name references multiple station_ids. 


